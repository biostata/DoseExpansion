# Dose Expansion

This project includes five R scripts and one stan file, described as follows in the order that they are called:

P. S. Boonstra, T. M. Braun, J. M. G. Taylor, K. M. Kidwell, E. L. Bellile, S. Daignault, L. Zhao, K. A. Griffith, T. S. Lawrence, G. P. Kalemkerian, M. J. Schipper; Statistical controversies in clinical research: building the bridge to phase II—efficacy estimation in dose-expansion cohorts, Annals of Oncology, Volume 28, Issue 7, 1 July 2017, Pages 1427–1435, https://doi.org/10.1093/annonc/mdx045

*decEfficacy.R* This function sources three helper scripts (*genParams.R*, *Functions.R*, and *titesimfunctions_phil_V2.R*; the user should not need to call any of these directly) which provide the suite of functions necessary to implement the simulation study in the AOC paper as well as a list called `arglist` as long as the number of unique simulation studies. By default, this is 60 (10 true toxicity and efficacy curves, two choices of skeleton, and three DEC/sample size configuations). Set `array_id` to be any number between 1 and 60, and this script will run a complete set of `niter` replications of this setting, saving the results in an `R` binary file called [array_id]`.R`. A single setting at the default number of iterations (`niter=2500`) takes ~20 hours to complete (for each `array_id`); it is expected that the user will distribute this script across a cluster to run in parallel. For testing, it is recommended to set `niter=5` or something similarly small. 

*Bayes2PLogit_OneGrp.stan* This is called in the process of running the above script and depends upon installation of the `rstan` package. The simulations in the paper were run on Stan V2.9.0 or thereabouts; users were not warned about the presence of 'divergent transitions' at this point (http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup) and will likely encounter these upon running this code. The likely cause in this file is the use of Cauchy priors - users should consider increasing the `adapt_delta` to something larger than 0.8 and/or increase the degrees of freedom on these priors. 

*analyzeSims.R* This code should be run after a successful run of *decEfficacy.R*. It will not function properly unless there exist files of the structure [file_name][i]`.R`. 